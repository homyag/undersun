{% load static %}
{% load i18n %}
{% load l10n %}
{% load url_utils %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Product",
  "name": "{{ property.title|escapejs }}",
  "description": "{{ property.short_description|default:property.description|striptags|truncatechars:400|escapejs }}",
  {% if property.property_type %}
  "category": "{{ property.property_type.name_display|escapejs }}",
  {% endif %}
  "additionalType": "{{ property.property_type|schema_additional_type }}",
  "image": [{% if property.images.exists %}{% for image in property.images.all %}"{{ image.medium_url|default:image.thumbnail_url|escape }}"{% if not forloop.last %}, {% endif %}{% endfor %}{% else %}"{% static 'images/no-image.svg' %}"{% endif %}],
  "numberOfRooms": {{ property.bedrooms|default:0 }},
  "floorSize": {
    "@type": "QuantitativeValue",
    "value": {{ property.area_total|default:'0'|unlocalize }},
    "unitCode": "MTK"
  },
  "address": {
    "@type": "PostalAddress",
    "addressLocality": "{{ property.location.name|default:property.district.name|default:''|escapejs }}",
    "addressRegion": "Phuket",
    "addressCountry": "TH"
  },
  "offers": {
    "@type": "Offer",
    "priceCurrency": "THB",
    "price": "{{ final_price|default:'0'|unlocalize }}",
    "availability": "{% if property.status == 'available' %}https://schema.org/InStock{% else %}https://schema.org/OutOfStock{% endif %}",
    "url": "{{ request.build_absolute_uri }}"
  }
}
</script>
